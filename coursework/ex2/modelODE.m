function dzdt = modelODE(t, z, burrowPos, rabbitSpeed, foxSpeed, warehouseNW, warehouseSW)      angleBetween = @(p1, p2) atan2(p2(2) - p1(2), (p2(1) - p1(1)));  rabbitPos = z(1:2);  foxPos = z(3:4);    % z = [Rx, Ry, Fx, Fy]  dzdt = zeros(size(z));  rabbitTheta = angleBetween(rabbitPos, burrowPos);    dzdt(1) = rabbitSpeed * cos(rabbitTheta);  dzdt(2) = rabbitSpeed * sin(rabbitTheta);  % fox aims for the rabbit  foxTarget = rabbitPos;  ##  if !isLineOfSight(foxPos, rabbitPos, warehouseNW, warehouseSW)##    ##    if foxPos(2) > warehouseSW(2)##      foxTarget = warehouseSW;##    else##       foxTarget = warehouseNW;##    end##  end##    foxTheta = angleBetween(foxPos, foxTarget);  dzdt(3) = cos(foxTheta) * foxSpeed;  dzdt(4) = sin(foxTheta) * foxSpeed;  
endfunction