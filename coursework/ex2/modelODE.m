function dzdt = modelODE(t, z, burrowPos, rabbitSpeed, foxSpeed, warehouseNW, warehouseSW)  Y = 2; # index of y in pos  X = 1; # index of x in pos    angleBetween = @(p1, p2) atan2(p2(Y) - p1(Y), (p2(X) - p1(X)));  rabbitPos = z(1:2);  foxPos = z(3:4);    % z = [Rx, Ry, Fx, Fy]  dzdt = zeros(size(z));  rabbitTheta = angleBetween(rabbitPos, burrowPos);    dzdt(1) = rabbitSpeed * cos(rabbitTheta);  dzdt(2) = rabbitSpeed * sin(rabbitTheta);  % fox aims for the rabbit  foxTarget = computeFoxTarget(rabbitPos, foxPos, warehouseNW, warehouseSW);  endif    foxTheta = angleBetween(foxPos, foxTarget);  dzdt(3) = cos(foxTheta) * foxSpeed;  dzdt(4) = sin(foxTheta) * foxSpeed;  
endfunction