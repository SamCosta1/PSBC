function dzdt = complexModelODE(t, z, burrowPos, ...                                rabbitSpeed, foxSpeed, ...                                warehouseNW, warehouseSW, ...                                rabbitSpeedRate, foxSpeedRate)  Y = 2; # index of y in pos  X = 1; # index of x in pos    angleBetween = @(p1, p2) atan2(p2(Y) - p1(Y), (p2(X) - p1(X)));  rabbitPos = z(1:2);  foxPos = z(3:4);    % z = [Rx, Ry, Fx, Fy, DistRabbit, DistFox]  dzdt = zeros(size(z));  rabbitTheta = angleBetween(rabbitPos, burrowPos);  currentRabbitSpeed = rabbitSpeed * exp(-rabbitSpeedRate * z(5));  dzdt(1) = currentRabbitSpeed * cos(rabbitTheta);  dzdt(2) = currentRabbitSpeed * sin(rabbitTheta);  % fox aims for the rabbit  foxTarget = computeFoxTarget(rabbitPos, foxPos, warehouseNW, warehouseSW);    foxTheta = angleBetween(foxPos, foxTarget);  currentFoxSpeed = foxSpeed * exp(-foxSpeedRate * z(6));  dzdt(3) = cos(foxTheta) * currentFoxSpeed;  dzdt(4) = sin(foxTheta) * currentFoxSpeed;    dzdt(5) = sqrt(dzdt(1)^2 + dzdt(2)^2);  dzdt(6) = sqrt(dzdt(3)^2 + dzdt(4)^2);  endfunction