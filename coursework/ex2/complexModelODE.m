function dzdt = complexModelODE(t, z, burrowPos, ...                                rabbitSpeed, foxSpeed, ...                                warehouseNW, warehouseSW, ...                                rabbitSpeedRate, foxSpeedRate)  Y = 2; # index of y in pos  X = 1; # index of x in pos    % z = [Rx, Ry, Fx, Fy]    dzdt = zeros(size(z));    % Converted into row vectors to match input parameters  rabbitPos = z(1:2)';  foxPos = z(3:4)';   % rabbit velocity    currentRabbitSpeed = rabbitSpeed * exp(-rabbitSpeedRate * z(5));  dzdt(1:2) = computeVelocity(currentRabbitSpeed, rabbitPos, burrowPos)';   % fox velocity  foxTarget = computeFoxTarget(rabbitPos, foxPos, warehouseNW, warehouseSW);    currentFoxSpeed = foxSpeed * exp(-foxSpeedRate * z(6));    dzdt(3:4) = computeVelocity(currentFoxSpeed, foxPos, foxTarget)';    % the line integral (for the distance travelled)   dzdt(5) = sqrt(dzdt(1)^2 + dzdt(2)^2);  dzdt(6) = sqrt(dzdt(3)^2 + dzdt(4)^2);  endfunction